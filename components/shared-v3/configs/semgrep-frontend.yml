rules:
  # Frontend-only constants enforcement
  - id: frontend-enforce-constants
    languages: [javascript, typescript]
    message: "Use constants. Put feature constants in frontend/src/**/constants/ and shared constants in frontend/src/constants/."
    severity: ERROR
    patterns:
      - pattern-either:
          # Numbers (except -1, 0, 1)
          - pattern: $N
          # Strings in common mutation/usage contexts
          - pattern: $VAR = "$S"
          - pattern: $VAR = '$S'
          - pattern: return "$S"
          - pattern: return '$S'
          - pattern: $F(..., "$S", ...)
          - pattern: $F(..., '$S', ...)
      - metavariable-regex:
          metavariable: $N
          regex: '^(?!-?1$|0$)(?:-?[0-9]+(?:\.[0-9]+)?)$'
    paths:
      include:
        - /frontend/src/**
      exclude:
        - /frontend/src/**/constants/**
        - /frontend/src/constants/**

  # Shared JavaScript/TypeScript security rules
  - id: no-eval
    languages: [javascript, typescript]
    patterns:
      - pattern: eval($X)
    message: Avoid eval; use safe alternatives.
    severity: ERROR

  - id: no-new-function
    languages: [javascript, typescript]
    patterns:
      - pattern: new Function($ARGS)
    message: Avoid dynamic Function constructors.
    severity: ERROR

  - id: no-child-process
    languages: [javascript, typescript]
    patterns:
      - pattern-either:
          - pattern: require('child_process').$METHOD(...)
          - pattern: import 'child_process'
    message: Avoid child_process in repo code.
    severity: ERROR
